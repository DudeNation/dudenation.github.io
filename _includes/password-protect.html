{% assign post_locked = page.locked | default: false %}
{% assign retired_date = page.retired_date | default: false %}
{% assign post_content = include.content | default: content %}

{% if post_locked %}
  {% if retired_date %}
    {% assign retired = retired_date | date: '%s' %}
    {% assign now = 'now' | date: '%s' %}
    {% if retired <= now %}
      {% assign post_locked = false %}
    {% endif %}
  {% endif %}
{% endif %}

{% if post_locked %}
<div class="locked-post-container" style="text-align: center; padding: 3rem 2rem; border: 2px solid var(--main-border-color); border-radius: 8px; margin: 2rem 0; background-color: var(--card-bg); box-shadow: var(--card-shadow);">
  <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.8;">ğŸ”’</div>
  <h3 style="margin-bottom: 1rem; color: var(--heading-color);">Post is Locked</h3>
  <p style="color: var(--text-color); font-size: 1.1rem; line-height: 1.6;">
    This post is currently locked and will be published when the machine is retired.
  </p>
  {% if retired_date %}
  <p style="color: var(--text-muted-color); font-size: 0.9rem; margin-top: 1rem;">
    Expected publication date: {{ retired_date | date: "%B %d, %Y" }}
  </p>
  {% endif %}
  <p style="color: var(--text-muted-color); font-size: 0.9rem; margin-top: 0.5rem;">
    Please check back later for the full writeup.
  </p>
</div>
{% else %}
{{ post_content }}
{% endif %}

